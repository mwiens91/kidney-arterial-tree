<html>
	<head>
		<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
		<meta content="utf-8" http-equiv="encoding">

		<!-- don't throw me errors about not having a favicon -->
		<link rel="icon" href="data:,">

		<!-- bootstrap -->
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
		<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>

		<!-- d3 -->
		<script type="text/javascript" src="https://d3js.org/d3.v7.min.js"></script>

		<!-- css -->
		<link rel="stylesheet" type="text/css" href="css/style.css" />
	</head>
	<body>
		<div class="container pt-3">
			<div class="row">
				<!-- the tree -->
				<div class="col text-center" id="div-svg">
					<svg width=750 height=750></svg>
				</div>
			</div>
			<div class="row pt-2">
				<!-- the right column -->
				<div class="col-sm-auto p-0 m-0" style="min-width: 300px">
					<!-- the options form -->
					<div class="bg-light pt-3" style="padding-left: 15px; padding-right: 15px; padding-bottom: 1px">
						<form id="form-options">
							<div class="mb-3">
								<label for="form-select" class="form-label">tree type</label>
								<div>
									<select id="form-select" class="form-select" aria-label="select-tree">
										<option selected value="ABT">ABT</option>
										<option value="KSABT">KSABT</option>
									</select>
								</div>
							</div>
							<div class="mb-3">
								<label for="input-init-diam" class="form-label">initial diameter (≥30μm)</label>
								<div class="input-group">
									<input type="number" id="input-init-diam" value=100 min=30 step="any" class="form-control" required>
									<span class="input-group-text">μm</span>
								</div>
							</div>
							<div class="input-group mb-3">
								<label for="input-angle-delta" class="form-label">angle Δ</label>
								<input type="range" class="form-range" id="input-angle-delta" value=40>
							</div>
							<div class="form-check form-switch mb-3">
								<input class="form-check-input" type="checkbox" role="switch" id="input-nephron" checked>
								<label class="form-check-label" for="input-nephron">draw nephrons</label>
							</div>
							<div class="mb-3">
								<button type="submit" id="generate-button" class="btn btn-primary">generate</button>
							</div>
						</form>
					</div>
				</div>
				<!-- the left column -->
				<div class="col order-md-first overflow-auto" style="margin-right: 4.5em">
					<h1 style="margin-bottom: 0.5em">Kidney arterial network</h1>
					<h2>Overview</h2>
					<p>
						The kidneys are essential components in
						regulating properties of our blood (for example,
						blood pressure, acidity, etc.) so that these
						properties lie within ranges in which we don't
						die. Despite each kidney accounting for ~0.5% of
						body weight, the kidneys receive ~20% of cardiac
						output. <a href="#ref-1">[1]</a>
					</p>
					<p>
						The functional unit of the kidney is the
						nephron. Each human kidney contains between
						0.30–1.4 million nephrons <a href="#ref-2">[2]</a>
						(note that this wide range correctly implies
						that the kidneys are almost magically able to
						safely compensate for substantial nephron loss).
					</p>
					<p>
						Nephrons couple and synchronize through
						hemodynamic interactions (nephrons share common
						blood vessels that "feed them")
						and electrical signals (nephrons have
						<a href="https://en.wikipedia.org/wiki/Tubuloglomerular_feedback">a feedback mechanism</a>
						that transmits electrical messages across cells).
						Understanding synchronization behaviour
						therefore requires understanding the vascular structure
						that connects nephrons. This vascular structure
						is an ongoing and active area of research.
					</p>
					<p>
						In 2016, D.D Postnov <i>et al.</i> published the paper
						<a href="#ref-3">[3]</a> which provides an algorithm
						for generating accurate representations of the kidney's
						vascular topology: this algorithm is visualized
						in the tree at the top of this page. Main blood vessels are
						represented in <span style="color: #FF0000">red</span>,
						<a href="https://en.wikipedia.org/wiki/Afferent_arterioles">afferent arterioles</a>
						are represented in
						<span style="color: #008000">green</span>, and nephrons (if you choose to draw them)
						are represented by <b>black</b> circles.
					</p>
					<p>
						There are two algorithms represented here: the
						asymmetric bifurcating tree (ABT), and the
						kidney-specific asymmetric bifurcating tree
						(KSABT). The ABT is a simpler algorithm
						which describes the general branching
						patterns that blood vessels exhibit in the
						kidney. The KSABT, which is the "true"
						structure, follows the same branching patterns
						as the ABT, but nephrons are additionally
						allowed to branch off of main blood vessels
						before they split into daughter vessels.
					</p>
					<h2>Usage</h2>
					<p>
						In the "options panel" you have a few
						options:
					</p>
					<ul style="margin-left: -5px">
						<li>
							<b>tree type</b>:
							selects which kind of tree you want to
							draw (described in the "Overview" section)
						</li>
						<li>
							<b>initial diameter</b>:
							this controls the diameter of the largest
							vessel and ultimately dictates the size of the tree.
							<i>Careful!</i> Going above values ≥300μm
							can cause serious slowdowns.
						</li>
						<li>
							<b>angle Δ</b>:
							this controls the spread of the tree
						</li>
						<li>
							<b>draw nephrons</b>:
							this determines whether to draw nephrons;
							note that for large trees or for the KSABT
							you might want to disable this to reduce clutter
						</li>
					</ul>
					<p>
						You can also <b>zoom/pan</b> using a
						mouse, or if you're on mobile, by inputting
						the appropriate gestures.
					</p>
					<h2>A note about interpretation</h2>
					<p>
						The algorithms described in
						<a href="#ref-3">[3]</a> specify the lengths of
						vessels and where along these lengths daughter
						vessels branch from. The actual angles (in 3D-
						or 2D-space) at which daughter vessels branch
						are not included in the algorithm; in this
						sense, the tree you see is fictitious. Do the
						actual angles matter, though? It depends on what
						you're studying. If you're looking at nephron
						synchronization then the answer is "no". Neither
						the hemodynamic interactions nor the electrical
						signals which cause synchronization care about
						angles of blood vessels; only the length of
						vessels and where branching happens matter.
					</p>
					<h2>References</h2>
					<div id="ref-1" style="margin-bottom: 0.5em">
						[1] J. Arciero, L. Ellwein, A. N. F. Versypt, E. Makrides, and A. T. Layton, “Modeling Blood Flow Control in the Kidney,” in <i>Applications of Dynamical Systems in Biology and Medicine</i>, New York, NY, 2015, pp. 55–73. doi: <a href="https://doi.org/10.1007/978-1-4939-2782-1_3">10.1007/978-1-4939-2782-1_3</a>.
					</div>
					<div id="ref-2" style="margin-bottom: 0.5em">
						[2] A. T. Layton, L. C. Moore, and H. E. Layton, “Multistable Dynamics Mediated by Tubuloglomerular Feedback in a Model of Coupled Nephrons,” <i>Bull. Math. Biol.</i>, vol. 71, no. 3, p. 515, Feb. 2009, doi: <a href="https://doi.org/10.1007/s11538-008-9370-x">10.1007/s11538-008-9370-x</a>.
					</div>
					<div id="ref-3" style="margin-bottom: 1rem">
						[3] D. D. Postnov <i>et al.</i>, “Modeling of Kidney Hemodynamics: Probability-Based Topology of an Arterial Network,” <i>PLOS Computational Biology</i>, vol. 12, no. 7, p. e1004922, Jul. 2016, doi: <a href="https://doi.org/10.1371/journal.pcbi.1004922">10.1371/journal.pcbi.1004922</a>.
					</div>
					<h2>About</h2>
					<p>
						The source code for this page is available
						<a href="https://github.com/mwiens91/kidney-arterial-tree">here</a>.
						In terms of the tech used, the code is written in JavaScript
						and the tree is rendered using the <a href="https://d3js.org/">D3.js</a> library.
						The styling of this page is mostly <a href="https://getbootstrap.com/">Bootstrap</a>.
					</p>
				</div>
			</div>
		</div>

		<script type="module" src="js/main.js"></script>
	</body>
</html>
